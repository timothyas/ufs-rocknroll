# Why the hell is this yaml file necessary... it just repeats everything
# Atmosphere model configuration settings.
atmos_general:

     # Define the calendar type for the FV3 simulation; currently
     # supported options are:

     # 0; no-calendar

     # 1; thirty-day months
          
     # 2; julian

     # 3; gregorian

     # 4; noleap
     calendar: 2

     # Define the production forecast length; units are seconds.
     fcst_length_seconds: 604800 

     # Define the production forecast history output frequency; units
     # are seconds.
     hist_freq_seconds: 10800

     # Define whether to perform in-time post-processing of the
     # production forecast output using the NCEP Unified
     # Post-Processor (UPP).
     do_post: True

     # Define the restart file creation frequency for the UFS-RNR
     # production forecast; units are seconds.
     restart_freq_seconds: 86400

     # Define the path to the file containing the vertical levels for
     # the atmosphere model.
     vcoord_filepath: !ENV ${HOMErnr}/fix/fv3/fix_am/global_hyblev.l128.txt

     # Define the path to the model_configure template file.
     model_configure_tmpl: !ENV ${rocknroll}/experiments/small-letkf/model_configure.tmpl

     # Define the UFS-RNR I/O data table template file (i.e.,
     # data_table); this file is used by the UFS-RNR for run-time
     # output.
     data_table_tmpl: !ENV ${PARMrnr}/ufs_rnr/data_table.tmpl

     # Define the UFS-RNR I/O diagnostic table template file (i.e.,
     # diag_table); this file is used by the UFS-RNR for run-time
     # output.
     diag_table_tmpl: !ENV ${rocknroll}/experiments/small-letkf/diag_table.tmpl

     # Define the UFS-RNR I/O field table template file (i.e.,
     # field_table); this file is used by the UFS-RNR for run-time
     # output.
     field_table_tmpl: !ENV ${PARMrnr}/ufs_rnr/field_table.tmpl

     # Define the coupler file prefix; this file is generated by the
     # UFS to faciliate the coupling of the respective component
     # models; the format for these files is typically as follows:

     # <file_prefix>.%Y-%m-%d-<total_seconds_of_day>.nc
     coupler_file_prefix: ufs.s2s.cpl.r

     # Define the top-level directory corresponding to the location of
     # the cubed-sphere grid, orography, and surface climatology
     # files; if this path does not exist, it will be created by the
     # UFS-RNR grids task; if a user is executing a UFS-RNR experiment
     # using previously generated grid files, the UFS-RNR expects to
     # find this path and sub-directories corresponding to the
     # resolutions (e.g., C96) for each component of the UFS-RNR
     # atmosphere model.
     cubed_sphere_path: !ENV ${HOMErnr}/fix/grids/atmos

     # Deterministic forecast general settings.
     deterministic:

          # Specify whether to turn on incremental analysis update
          # (IAU).
          do_iau: False

          # Specify whether to turn on cellular autonoma methods.
          do_ca: True
          
          # Specify whether to turn on stochastic physics
          # perturbations.
          do_stochy: True
     
          # Define the time-step for the UFS; units are seconds.
          dt_atmos: 900
          
          # Define the atmosphere model coupling interval; used only
          # if the UFS is implementing the coupled-modeling system;
          # units are seconds.
          coupling_interval_sec: 900

          # Define the path to the input.nml template file.
          input_nml_tmpl: !ENV ${PARMrnr}/atmos/input.nml.tmpl

          # Define the path to the med_modelio.nml template file.
          med_modelio_nml_tmpl: !ENV ${PARMrnr}/atmos/med_modelio.nml.tmpl

          # Define the total number of (un-staggered) vertical levels.
          nlevs: 127

          # Define the path to the pio_in template file.
          pio_in_tmpl: !ENV ${PARMrnr}/atmos/pio_in.tmpl

          # Define the FV3 application namelist parameter settings;
          # NOTE: these require the respective FV3 namelist template
          # to have the appropriate template parsing attributes in
          # place.
          fv3_nml_params:
               n_sponge: 42
               ccpp_suite: FV3_GFS_v16_coupled_nsstNoahmpUGWPv1
               tau: 10.0
               rf_cutoff: 7500.0
               d2_bg_k1: 0.15
               d2_bg_k2: 0.04
               k_split: 2
               n_split: 6
               dddmp: 0.2
               dnats: 1
               hord_mt: 5
               hord_vt: 5
               hord_tm: 5
               hord_dp: -5
               hord_tr: 8
               imp_physics: 11
               do_sat_adj: True
               ialb: 2
               iems: 2
               iaer: 1011
               hybedmf: False
               lheatstrg: True
               bl_mynn_edmf: 1
               bl_mynn_tkeadvect: True
               bl_mynn_edmf_mom: 1
               fscav_aero: '*:0.0'
               nstf_name: 2,1,0,0
               do_ugwp_v1_orog_only: False
               knob_ugwp_ndx4lh: 4
               knob_ugwp_dokdis: 2
               
          # Define the cubed-sphere resolution.
          resolution: C96

     # Ensemble forecast general settings.
     ensemble:

          # Specify whether to turn on incremental analysis update
          # (IAU) for the respective ensemble members.
          do_iau: False

          # Specify whether to turn on cellular autonoma methods.
          do_ca: True
          
          # Specify whether to turn on stochastic physics
          # perturbations for the respective ensemble members.
          do_stochy: True
          
          # Define the number of iterations; this is required of the
          # stochastic physics to define the random number generator
          # seeds for the respective stochastic physics methods.
          niter: 1
     
          # Define the time-step for the UFS; units are seconds.
          dt_atmos: 900
          
          # Define the atmosphere model coupling interval; used only
          # if the UFS is implementing the coupled-modeling system;
          # units are seconds.
          coupling_interval_sec: 900
          
          # Define the path to the input.nml template file.
          input_nml_tmpl: !ENV ${PARMrnr}/atmos/input.nml.tmpl

          # Define the path to the med_modelio.nml template file.
          med_modelio_nml_tmpl: !ENV ${PARMrnr}/atmos/med_modelio.nml.tmpl

          # Define the total number of (un-staggered) vertical levels.
          nlevs: 127

          # Define the path to the pio_in template file.
          pio_in_tmpl: !ENV ${PARMrnr}/atmos/pio_in.tmpl

          # Define the FV3 application namelist parameter settings;
          # NOTE: these require the respective FV3 namelist template
          # to have the appropriate template parsing attributes in
          # place.
          fv3_nml_params:
               iau_filter_increments: False
               n_sponge: 42
               ccpp_suite: FV3_GFS_v16_coupled_nsstNoahmpUGWPv1
               tau: 10.0
               rf_cutoff: 7500.0
               d2_bg_k1: 0.15
               d2_bg_k2: 0.04
               k_split: 2
               n_split: 6
               dnats: 1
               dddmp: 0.2
               hord_mt: 5
               hord_vt: 5
               hord_tm: 5
               hord_dp: -5
               hord_tr: 8
               imp_physics: 11
               do_sat_adj: True
               ialb: 2
               iems: 2
               iaer: 1011
               hybedmf: False
               lheatstrg: True
               bl_mynn_edmf: 1
               bl_mynn_tkeadvect: True
               bl_mynn_edmf_mom: 1
               fscav_aero: '*:0.0'
               nstf_name: 2,1,0,0
               do_ugwp_v1_orog_only: False
               knob_ugwp_ndx4lh: 4
               knob_ugwp_dokdis: 2
               shum: 0.005
               shum_tau: 21600
               shum_lscale: 5000000
               sppt: 0.5
               sppt_tau: 21600
               sppt_lscale: 500000
               sppt_logit: True
               sppt_sfclimit: True
               skeb: 0.3
               skeb_tau: 21600
               skeb_lscale: 250000
               skeb_vdof: 5
               skeb_npass: 30
               skebint: 0
               skebnorm: 0
               use_zmtnblck: True
               stochini: False
               new_lscale: True

          # Define the cubed-sphere resolution.
          resolution: C96

#----

# Atmosphere model grid settings.
atmos_grid:

     # Specify whether to scrub (i.e., remove) the associated
     # application files and working directory following delivery of
     # the application product files.
     scrub: True

     # Define the top-level directory corresponding to the location of
     # the cubed-sphere grid, orography, and surface climatology
     # files; if this path does not exist, it will be created by the
     # UFS-RNR grids task; if a user is executing a UFS-RNR experiment
     # using previously generated grid files, the UFS-RNR expects to
     # find this path and sub-directories corresponding to the
     # resolutions (e.g., C96) for each component of the UFS-RNR
     # atmosphere model.
     cubed_sphere_path: !ENV ${HOMErnr}/fix/grids/atmos

     # Define the total number of (un-staggered) vertical levels.
     nlevs: 127
     
     # The available options are for the cubed-sphere resolution are
     # as follows:

     # C12: ~8.0 degree
     # C24: ~4.0 degree
     # C48: ~2.0 degree
     # C96: ~1.0 degree
     # C192: ~0.5 degree
     # C384: ~0.25 degree
     # C768: ~0.125 degree
     
     # Deterministic forecast atmosphere model grid settings:
     deterministic:

          # The cubed-sphere resolution.
          resolution: C96

     # Ensemble member forecast atmosphere model grid specifications.
     ensemble:

          # The cubed-sphere resolution.
          resolution: C96

     # Define the path to the top-level fixed climatology (e.g.,
     # fix_sfc_climo) directory.
     fix_sfc_climo_gen_path: !ENV ${HOMErnr}/fix/fv3/fix_sfc_climo

     # Define the namelist template for the surface climatology
     # generation application.
     fix_sfc_climo_gen_nml: !ENV ${PARMrnr}/atmos/sfc_climo_gen.nml.tmpl

     # Define the path to the YAML-formatted file containing the
     # surface climatology generation fixed-files
     fix_sfc_climo_gen_yaml: !ENV ${PARMrnr}/atmos/fix_sfc_climo_gen.yaml

     # Define the path to the fixed files required to generate the FV3
     # orography.
     fix_orog_path: !ENV ${HOMErnr}/fix/fv3/fix_orog

     # Define the path to the YAML formatted file containing the key
     # and value pairs for the fixed files to be used to generate the
     # FV3 orography.
     fix_orog_yaml: !ENV ${PARMrnr}/atmos/fix_orog.yaml

#----

# Ice model configuration settings.
ice_model:

     # Define the path to the YAML-formatted file containing the ice
     # model (CICE) grid attribute files.
     fix_grid_yaml: !ENV ${PARMrnr}/ice/fix_cice_grid.yaml

     # Define the top-level directory corresponding to the ice model
     # grid configuration and attribute files; if this path does not
     # exist, it will be created by the UFS-RNR grids task; if a user
     # is executing a UFS-RNR experiment using previously generated
     # grid files, the UFS-RNR expects to find this path and
     # sub-directories corresponding to the supported resolutions of
     # 1.0-, 0.5-, and 0.25-degree (CICE1p0, CICE0p5, and CICE0p25,
     # respectively) for the UFS-RNR ice model.
     grid_path: !ENV ${HOMErnr}/fix/grids/ice
     
     # Define the basename for the ice model (CICE5) initial
     # conditions file; this is only used for cold-start applications.
     initconds_basename: cice5.ic.nc

     # Deterministic forecast settings.
     deterministic:

          # Define the ice model time step.
          dt: 900

          # Define the path to the ice_in template file.
          input_nml_tmpl: !ENV ${rocknroll}/experiments/small-letkf/ice_in.tmpl

          # The nominal grid resolution.
          resolution: 1.0
          
     # Ensemble forecast settings.
     ensemble:

          # Define the ice model time step.
          dt: 900

          # Define the path to the ice_in template file.
          input_nml_tmpl: !ENV ${rocknroll}/experiments/small-letkf/ice_in.tmpl

          # Define the nominal grid resolution.
          resolution: 1.0

#----

# Post-production (e.g., WMO-GRIB file generation) settings.
post:

     # Define the path to the path to the YAML-formatted file
     # containing the UFS post-processor fixed files.
     fix_post_yaml: !ENV ${PARMrnr}/production/post_fix.yaml

#----

# Ocean model configuration settings.
ocean_model:

     # Define the path to the YAML-formatted file containing the ocean
     # model (MOM6) grid attribute files.
     fix_grid_yaml: !ENV ${PARMrnr}/ocean/fix_mom6_grid.yaml

     # Define the basename for the ocean model (MOM6) initial
     # conditions file; this is only used for cold-start applications.
     initconds_basename: MOM6.ic.nc

     # Define the top-level directory corresponding to the ocean model
     # grid configuration and attribute files; if this path does not
     # exist, it will be created by the UFS-RNR grids task; if a user
     # is executing a UFS-RNR experiment using previously generated
     # grid files, the UFS-RNR expects to find this path and
     # sub-directories corresponding to the supported resolutions of
     # 1.0-, 0.5-, and 0.25-degree (MOM1p0, MOM0p5, and MOM0p25,
     # respectively) for the UFS-RNR ocean model.
     grid_path: !ENV ${HOMErnr}/fix/grids/ocean
     
     # Define the path to the MOM_input template file.
     mom_input_tmpl: !ENV ${PARMrnr}/ocean/MOM_input.tmpl
     
     # Define the path to the MOM_override template file.
     mom_override_tmpl: !ENV ${PARMrnr}/ocean/MOM_override.tmpl

     # Define the path to the MOM_resolution template file.
     mom_resolution_tmpl: !ENV ${PARMrnr}/ocean/MOM_resolution.tmpl

     # Define the total number of vertical levels.
     nlevs: 75   

     # Deterministic forecast settings.
     deterministic:

          # Define the ocean model baroclinic time step; for
          # coupled-model simulations, this is the coupling time-step.
          dt: 900

          # Define the ocean model thermodynamic and tracer advection
          # time-step.
          dt_therm: 3600

          # Define the nominal grid resolution.
          resolution: 1.0

     # Ensemble forecast settings.
     ensemble:

          # Define the ocean model baroclinic time step; for
          # coupled-model simulations, this is the coupling time-step.
          dt: 900

          # Define the ocean model thermodynamic and tracer advection
          # time-step.
          dt_therm: 3600

          # Define the nominal grid resolution.
          resolution: 1.0

     # MOM6 (nominally) 1-degree configuration settings.
     MOM1p0:

          # The following are namelist and input file specific
          # variables; it is assumed that the key is a variable that
          # is to be templated and the value is the corresponding
          # information (e.g., string, float, integer, etc.,) to be
          # assigned to the respective key.
          chl_varname: chl_a
          mixedlayer_restrat: True
          use_kh_bg_2d: True
          restart_checksums_required: False
          liquid_runoff_from_data: True
          
     # MOM6 (nominally) 0.25-degree configuration settings.
     MOM0p25:

          # The following are namelist and input file specific
          # variables; it is assumed that the key is a variable that
          # is to be templated and the value is the corresponding
          # information (e.g., string, float, integer, etc.,) to be
          # assigned to the respective key.
          chl_varname: chlor_a
          mixedlayer_restrat: True
          use_kh_bg_2d: False
          restart_checksums_required: False
          liquid_runoff_from_data: True
